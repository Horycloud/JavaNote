[**「算法入门笔记」卡特兰数**](https://zhuanlan.zhihu.com/p/97619085)

[**「一分钟数学——卡特兰数（上）」**](https://www.cnblogs.com/caiyishuai/articles/9047777.html)

+ 只看第一个前缀和小于零的前缀，不管后面的前缀和小于零的前缀有多少，只要是一个非法排列，肯定能找到这样的一个“第一个前缀，它的前缀和小于0，而且肯定是等于-1的”，但是想找到所有的A不容易，于是，我们想到了与A一一对应的B（既然一一对应了，那么A的个数肯定等于B），找B的个数就容易多了。

+ 我们知道：A和“能找到第一个前缀，它的前缀和等于-1”是互为充要条件的。

+ 由前面的A得出的B，意思是，如果他是个B，那么它肯定满足“有 n + 1 个 +1 以及 n - 1 个 -1”，那么由“有 n + 1 个 +1 以及 n - 1 个 -1”能不能推出它就是个B呢？

+ 那么什么是B呢，也就是说，满足什么条件它就是个B呢









非法序列怎么求？乍看之下完全没思路啊，如果用暴力解法那未免不要太麻烦，这时候我们采用逆向思维，就会发现这个问题并没有想象的那么难，公式如下：

合法序列数 = 总序列数 - 非法序列数

所以我们只需要求出总序列数和非法序列数然后相减即可得出合法序列数

总序列数很好求，即 $C^{n}_{2n}$ ，那么非法序列数怎么求呢？

还是逆向思维，说实话直接求非法序列数同样比较难求，但是我们可以这样：

求得与非法序列数一一对应的另一种序列数，为了方便描述，这里称非法序列为A，与A相对应的另一种序列为B，对于B的定义是这样的：由于A是一个非法序列，必然存在某个位置的前缀和小于0的情况，那么，从左往右看，可以肯定的是，从某个位置开始，该位置前缀和突然小于0，且必然是-1（因为该位置是第一次前年缀和小于0 的位置），比如序列：+1 -1 -1 +1 -1 +1，第三个1的前缀和首次小于0，那么我们就将该位置（包含该位置）之前的数字取反就得到了与A相对应的的序列B：-1 +1 +1 +1 -1 +1，（怎么证明A和B是一一对应的关系呢？这么后面会讲，这里先记着肯定是一一对应的即可），这时候求得序列B的个数，即可得出A的个数，那么怎么求B的个数呢？

对于B，由于其是将A的第一个前缀和小于零的位置（包含该位置）之前的数取反得来的，所以`每个 B 都有 (n + 1) 个 +1 以及 (n - 1) 个 -1`，那么B的数量为 $C^{n+1}_{2n}$ ，则A的数量同为 $C^{n+1}_{2n}$ 。

则合法序列数 = 总序列数 - 非法序列数 = $C^{n}_{2n}$ - $C^{n+1}_{2n}$ 

还有个问题，那么怎么证明A和B是一一对应的关系呢？

+ 因为每个 A 只有一个"**第一个前缀和小于 0 的前缀**"，所以每个 A 只能产生一个 B。而每个 B 想要还原到 A，就需要找到"**第一个前缀和大于 0 的前缀**"，显然 B 也只能产生一个 A
+ 故A和B一一对应



出栈序列的 **所有前缀和** 必然大于等于 0，也就是说入栈的数的个数总是要大于或者等于出栈数的个数（不入栈怎么出栈啊~）

同时满足以下条件即可转化为`卡特兰数问题`：

+ ①  +1和-1的个数相同皆为n个（这里+1和-1是虚指，代表两种事物，且只有这两种）
+ ② 序列每个位置的前缀和均大于等于0

最终，满足该条件的序列数为：$C^{n}_{2n}$ - $C^{n+1}_{2n}$ ，另一种形式则为：$C^{n}_{2n}$ /(n+1)



1. 「阿里笔试题」12个高矮不同的人，排成两排，每排必须是从矮到高排列，而且第二排比对应的第一排的人高，问排列方式有多少种?

   C(12，6)-C(12，5)